<div class="card border-warning mb-3">
  <div class="card-header bg-warning-subtle d-flex justify-content-between align-items-center">
    <div><b>Нераспределённая добыча</b> — склад: <span class="badge bg-dark">Шахта</span></div>
    <small class="text-muted">Всего к принятию: <b>{{ "%.2f"|format(pending_total or 0) }}</b> т</small>
  </div>
  <div class="card-body">
    {% if pending_rows %}
    <form method="post" action="{{ url_for('moves.pending_action') }}">
      <div class="table-responsive">
        <table class="table table-sm table-hover align-middle">
          <thead><tr>
            <th><input type="checkbox" onclick="document.querySelectorAll('.pchk').forEach(c=>c.checked=this.checked)"></th>
            <th>Дата</th><th>Продукт</th><th class="text-end">Кол-во</th><th>Ед.</th><th>Источник</th><th>Док</th><th>Прим.</th>
          </tr></thead>
          <tbody>
          {% for r in pending_rows %}
            <tr class="table-warning">
              <td><input class="pchk" type="checkbox" name="ids" value="{{ r.id }}"></td>
              <td>{{ r.dt }}</td>
              <td>{{ r.product }}</td>
              <td class="text-end">{{ r.qty }}</td>
              <td>{{ r.unit }}</td>
              <td>{{ r.source }}</td>
              <td>{{ r.doc }}</td>
              <td>{{ r.note }}</td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
      <div class="d-flex gap-2">
        <button name="op" value="accept" class="btn btn-success">Принять на склад</button>
        <button name="op" value="cancel" class="btn btn-outline-danger">Списать</button>
      </div>
    </form>
    {% else %}
      <div class="text-muted">Нет ожидающих строк из «Отчёта о добыче».</div>
    {% endif %}
  </div>
</div>
